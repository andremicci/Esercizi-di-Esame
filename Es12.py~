
from ROOT import *
import numpy as np
import math as m
import matplotlib.pyplot as plt
import  scipy.stats as stats


rnd=TRandom3()
rnd.SetSeed(192239)
h=TH1D("h","h",100,0.0,60)


mu=30
x=np.array([])

ntot=50000
for i in range(ntot):

    N=0
    S=0
    while True:
        
        dt=-np.log(1-rnd.Rndm())
        S=S+dt
        
        N=N+1
        if S>mu:
            break

    
    h.Fill(N-1)
    x=np.append(x,N-1)
    

h.Draw()
f=stats.poisson(mu)
D,pvalue=stats.kstest(x,f.cdf)
print(pvalue)
 

gApplication.Run(True)
